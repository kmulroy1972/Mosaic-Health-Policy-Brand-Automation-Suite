# Test Harness Quick Start

| Command                 | Description                                                                    |
| ----------------------- | ------------------------------------------------------------------------------ |
| `pnpm test:unit`        | Jest unit coverage for shared utilities, AI routing, GraphClient.              |
| `pnpm test:integration` | Playwright integration smoke (requires `MHP_E2E=true`).                        |
| `pnpm test:a11y`        | axe-core analysis of task panes (`MHP_A11Y=true`).                             |
| `pnpm test:throttle`    | Synthetic 429/Retry-After harness exercising Graph backoff.                    |
| `pnpm test:offline`     | Offline queue verification against Word task pane (requires running dev host). |
| `pnpm test:pdf`         | veraPDF compliance on exported samples (Docker required).                      |
| `pnpm test:identity`    | NAA + OBO matrix using identity mocks.                                         |

### Prerequisites

- Start the dev host: `pnpm --filter apps/dev-host dev` (serves task panes at `https://localhost:3000`).
- Trust the self-signed cert or run `PLAYWRIGHT_SKIP_SSL_ERRORS=1`.
- Install Playwright browsers once per machine: `pnpm exec playwright install --with-deps`.
- Pull veraPDF container before running PDF validation: `docker pull verapdf/verapdf`.

### Environment flags

- `MHP_E2E=true` – enables Playwright specs that interact with Office task panes.
- `MHP_A11Y=true` – runs axe-core audits (skip by default to keep CI light).
- `CI=true` – recommended for headless pipelines.

### Artefacts

- Playwright HTML reports: `coverage/playwright`.
- axe JSON reports: stored under `coverage/accessibility` (generated by specs).
- veraPDF XML reports: `coverage/veraPDF`.
